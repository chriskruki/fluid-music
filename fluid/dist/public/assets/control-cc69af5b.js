import"./modulepreload-polyfill-3cfb730f.js";let s,p,r,u,i=null,l=!1,g=null;function h(){var t,e,n,o,y,f;s=document.getElementById("control-canvas"),s.getContext("2d"),p=document.getElementById("connection-dot"),r=document.getElementById("connection-status"),u=document.getElementById("instructions"),(t=document.getElementById("random-splats"))==null||t.addEventListener("click",I),(e=document.getElementById("pattern-right"))==null||e.addEventListener("click",()=>d("right")),(n=document.getElementById("pattern-left"))==null||n.addEventListener("click",()=>d("left")),(o=document.getElementById("pattern-up"))==null||o.addEventListener("click",()=>d("up")),(y=document.getElementById("pattern-down"))==null||y.addEventListener("click",()=>d("down")),(f=document.getElementById("pattern-corners"))==null||f.addEventListener("click",()=>d("corners")),S(),window.addEventListener("resize",v)}function v(){if(!s)return;const t=document.getElementById("canvas-container");t&&(s.width=t.clientWidth,s.height=t.clientHeight)}function E(){const e=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;i=new WebSocket(e),i.onopen=w,i.onmessage=C,i.onclose=k,i.onerror=L}function w(){console.log("WebSocket connection established"),l=!0,m(!0),c({type:"connect",payload:{role:"controller"}})}function C(t){try{const e=JSON.parse(t.data);switch(e.type){case"connect_ack":g=e.payload.sessionId,console.log(`Connected with ID: ${g}`),r.textContent=`Connected (Controllers: ${e.payload.connectedClients.controllers}, Simulators: ${e.payload.connectedClients.simulators})`;break;case"client_counts":r.textContent=`Connected (Controllers: ${e.payload.controllers}, Simulators: ${e.payload.simulators})`;break;default:console.log("Received message:",e)}}catch(e){console.error("Error processing message:",e)}}function k(){console.log("WebSocket connection closed"),l=!1,m(!1),setTimeout(E,5e3)}function L(t){console.error("WebSocket error:",t),l=!1,m(!1)}function m(t){t?(p.classList.add("connected"),r.textContent="Connected"):(p.classList.remove("connected"),r.textContent="Disconnected")}function c(t){i&&l&&i.send(JSON.stringify(t))}function a(t){const e=s.getBoundingClientRect(),n=(t.clientX-e.left)/e.width,o=(t.clientY-e.top)/e.height;return{x:n,y:o}}function S(){const t=new Map;s.addEventListener("mousedown",e=>{const n=a(e);c({type:"input",payload:{eventType:"mousedown",position:n}}),u.classList.add("hidden")}),s.addEventListener("mousemove",e=>{if(e.buttons!==1)return;const n=a(e);c({type:"input",payload:{eventType:"mousemove",position:n}})}),s.addEventListener("mouseup",e=>{const n=a(e);c({type:"input",payload:{eventType:"mouseup",position:n}})}),s.addEventListener("touchstart",e=>{e.preventDefault(),Array.from(e.changedTouches).forEach(n=>{const o=a(n);t.set(n.identifier,o),c({type:"input",payload:{eventType:"mousedown",position:o}})}),u.classList.add("hidden")}),s.addEventListener("touchmove",e=>{e.preventDefault(),Array.from(e.changedTouches).forEach(n=>{const o=a(n);t.set(n.identifier,o),c({type:"input",payload:{eventType:"mousemove",position:o}})})}),s.addEventListener("touchend",e=>{e.preventDefault(),Array.from(e.changedTouches).forEach(n=>{const o=a(n);t.delete(n.identifier),c({type:"input",payload:{eventType:"mouseup",position:o}})})})}function I(){c({type:"command",payload:{command:"random_splats",parameters:{count:10}}})}function d(t){c({type:"command",payload:{command:"preset_pattern",parameters:{patternName:t}}})}function B(){h(),v(),E()}window.addEventListener("load",B);
//# sourceMappingURL=control-cc69af5b.js.map
